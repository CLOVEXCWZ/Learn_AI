# 极大似然估计

## 1 作用 

- 在已知试验结果的(即样本)的情况下，用来估计这些样本分布的参数，把可能性最大的那个参数θ作为真实θ‘的参数估计

## 2 原理

- 极大似然估计是建立在极大似然原理的基础上的一个统计方法，是概率论在统计学中的应用。极大似然估计提供了一中给观察数据来评估模型参数的方法，即：“模型已定，参数未知”。通过若干次试验，观察其结果，利用试验结果得到某个参数值能够使样本出现的概率为最大，则称之为极大似然估计

## 3 说明

- 用一张图来说明

<img src="picture/101_101.png">

## 4 公式

### 4.1 离散型

$$
L(θ_1, θ_2,...θ_k)=\prod_{i=1}^{n}p(x_i;θ_1, θ_2,...,θ_k)
$$

### 4.2 连续型

$$
L(θ_1, θ_2,...θ_k)=\prod_{i=1}^{n}f(x_i;θ_1, θ_2,...,θ_k)
$$

## 5 例子

### 5.1 离散

已知X是离散型随机变量，可能的取值有0，1,  2。对应概率为：
$$
P\{X=0\}=θ^2\\
P\{X=1\}=2θ(1=θ)\\
P\{X=2\}=(1-θ)^2
$$
这里X更具体解释的话，可以理解为抛两次硬币，正面记1，反面记0，结果累加，只不过这里的硬币特殊，抛到反面的概率是[θ。](http://www.baidu.com/link?url=MJaoIE7AVnDzAZXRW2ArlCqD6Iau-GWrD2G2y4idRneUyWvm-uRxXuB9_6KDQSndF9ynu__z8qkiVrKOKPdWaq&wd=&eqid=b18f01e500020532000000035ad21615)

这时对X抽取容量为10的样本，其中有2个0、5个1、3个2，求θ的最大似然估计值。

- 1 写出似然函数

$$
L(x_1,x_2,...,X_10)=\prod_{i=1}^{10}P{X=x_i, θ}\\
= [θ^2]^2*[2θ(1-θ)]^5*[(1-θ)^2]^3\\
=2^5θ^9(1-θ)^11
$$

- 2 对似然函数去对数
  $$
  lnL=5ln2+9lnθ+11ln(1-θ)
  $$

- 3 求倒数
  $$
  对数求导\\
  (log_ax)'=\frac{1}{xlna}\\
  (lnx)'=\frac{1}{x}
  $$
  
  $$
  \frac{dlnL}{dθ}=\frac{d(5ln2+9lnθ+11ln(1-θ))}{dθ}\\
  =0+9*\frac{1}{θ}-11*\frac{1}{1-θ}\\
  =\frac{9}{θ}-\frac{11}{1-θ}
  $$
  
- 4 求似然方差
  $$
  \frac{9}{θ}-\frac{11}{1-θ}=0\\
  =>\frac{9}{θ}=\frac{11}{1-θ}\\
  =>θ=\frac{9}{20}
  $$
  

### 5.2 正态分布

​	假设样本服从正态分布
$$
N(\mu,\sigma^2)
$$


- 1 写出似然函数

$$
L(\mu, \sigma^2)=\prod_{i=1}^{N}\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x_i-\mu)^2}{2\sigma^2}}\\
=(2\pi\sigma^2)^{-\frac{n}{2}}e^{-\frac{1}{2\sigma^2}\sum_{i=1}^{n}(x_i-\mu)^2}
$$



- 2 求对数

$$
lnL(\mu, \sigma^2)=ln((2\pi\sigma^2)^{-\frac{n}{2}}e^{-\frac{1}{2\sigma^2}\sum_{i=1}^{n}(x_i-\mu)^2})\\
=ln(2\pi\sigma^2)^{-\frac{n}{2}}+lne^{-\frac{1}{2\sigma^2}\sum_{i=1}^{n}(x_i-\mu)^2}\\
=-\frac{n}{2}(ln(2\pi)+\sigma^2)-\frac{1}{2\sigma^2}\sum_{i=1}^{n}(x_i-\mu)^2
$$



- 3 求导

$$
\frac{dlnL(\mu,\sigma^2)}{d\mu}=\frac{1}{\sigma^2}\sum_{n}^{i=1}(x_i-\mu)\\
\frac{dlnL(\mu,\sigma^2)}{d\sigma^2}=-\frac{2}{\sigma^2}+\frac{1}{2\sigma^4}\sum_{i=1}^{n}(x_i-\mu)^2
$$

- 4 求解

  - 联合解得

  $$
  \mu*=x_{avg}=\frac{1}{n}\sum_{i=1}^{n}x_i\\
  \sigma^*2=\frac{1}{n}\sum_{i=1}^{n}(x_i-x_{avg})^2
  $$

  

